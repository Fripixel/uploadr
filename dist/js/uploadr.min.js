!function(e){var n={settings:null,button:null,getSettings:function(){return n.settings},getButton:function(){return n.button},load:function(t){n.settings=t,n.setCounter(t.qty),n.decrement(),e(".uploadr").on("click","a.close",function(t){t.preventDefault(),e(this).closest(".thumb").fadeOut("fast",function(){e(this).remove(),n.increment(),n.enable()})}),n.onClick()},enable:function(){n.button.css({"pointer-events":"auto",opacity:"1"})},onClick:function(){var t=n.getSettings();e(t.buttonID).on("click",function(){n.button=e(this),n.events(t)})},disable:function(){n.button.css({"pointer-events":"none",opacity:"0.5"})},setCounter:function(e){n.counter=e},increment:function(){return n.counter++},decrement:function(){return n.counter--},events:function(t){var o=t.inputName,i=t.multiple?t.multiple:null,a=t.accept,c=e("<input />",{type:"file","class":"hidden",accept:a,multiple:i,name:o,value:"xxx"}),r=e("<li />",{"class":"loaded"}).append(c);c.trigger("click"),c.on("change",function(o){var i=o.target.files,a=e("<div/>",{"class":"loader"});r.append(a),t.qty>0&&n.decrement()<=0&&n.disable(),e.each(i,function(e,t){n.render(t).done(function(e){a.html(e),r.addClass("thumb")})}),e("#preview").append(r)})},clean:function(){console.log(n.counter),e("#preview").find("li.loaded").each(function(){var t=e(this);console.log(t),t.hasClass("thumb")||(console.log("remover"),t.remove(),n.increment())})},render:function(n){var t=e.Deferred(),o=new FileReader;return o.onload=function(n){e("body").css("cursor","auto");var o=n.target.result,i="background-image:url("+o+");",a=e("<i/>",{"class":"fa fa-times-circle"}),c=e("<a/>",{href:"javascript:;","class":"close"}).html(a),r=e("<img />",{"class":"upload-img",style:i}),u=r.add(c);t.resolve(u)},o.onerror=function(){t.reject("Imagem n√£o pode ser renderizada.")},o.onprogress=function(n){e("body").css("cursor","wait");n.total,n.loaded;n.lengthComputable},o.readAsDataURL(n),t.promise()}};e.fn.uploadr=function(t){var o={buttonID:"#addfile",inputName:"images[]",accept:"image/x-png, image/gif, image/jpeg",multiple:null,qty:2},i=e.extend({},o,t);return this.each(function(){n.load(i)})}}(jQuery);