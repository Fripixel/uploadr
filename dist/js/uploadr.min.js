!function(t){"use strict";function e(e,s){this.element=e,this.settings=t.extend({},i,s),this._defaults=i,this._name=n,this.init()}var n="uploadr",i={buttonID:"#addfile",inputName:"images[]",accept:"image/x-png, image/gif, image/jpeg",multiple:null,qty:0,once:!1};t.extend(e.prototype,{counter:0,time:2e3,button:null,init:function(){var e=this;this.button=t(this.settings.buttonID),this.setCounter(this.settings.qty),this.decrement(),t(".uploadr").on("click","a.close",function(n){n.preventDefault(),t(this).closest(".thumb").fadeOut("fast",function(){t(this).remove(),e.increment(),e.enable()})}),this.onClick(),this.watch(this.settings)},getSettings:function(){return this.settings},getButton:function(){return this.button},watch:function(){var e=this,n=this.settings;setInterval(function(){t("#preview").find("li.thumb").length>0&&t("#preview").trigger("contentchange","data")},this.time),t("#preview").on("contentchange",function(){n.once&&e.disable()})},enable:function(){this.button.css({"pointer-events":"auto",opacity:"1"})},onClick:function(){var e=this,n=this.settings;t(n.buttonID).on("click",function(){e.events(n)})},disable:function(){this.button.css({"pointer-events":"none",opacity:"0.5"})},setCounter:function(t){this.counter=t},increment:function(){return this.counter++},decrement:function(){return this.counter--},events:function(){var e=this,n=this.settings,i=this.settings.inputName,s=this.settings.multiple?this.settings.multiple:null,o=this.settings.accept,c=t("<input />",{type:"file","class":"hidden",accept:o,multiple:s,name:i,value:"xxx"}),a=t("<li />",{"class":"thumb loaded"}).append(c);c.trigger("click"),c.on("change",function(i){var s=i.target.files,o=t("<div/>",{"class":"loader"});a.append(o),n.qty>0&&e.decrement()<=0&&e.disable(),t.each(s,function(n,i){e.render(i).done(function(e){o.html(e),t("body").css("cursor","auto")})}),t("#preview").append(a)})},clean:function(){t("body").css("cursor","wait")},render:function(e){var n=t.Deferred(),i=new FileReader;return i.onload=function(e){t("body").css("cursor","auto");var i=e.target.result,s="background-image:url("+i+");",o=t("<i/>",{"class":"fa fa-times-circle"}),c=t("<a/>",{href:"javascript:;","class":"close"}).html(o),a=t("<img />",{"class":"upload-img",style:s}),r=a.add(c);n.resolve(r)},i.onerror=function(){n.reject("Imagem n√£o pode ser renderizada.")},i.onprogress=function(e){t("body").css("cursor","wait");e.total,e.loaded;e.lengthComputable},i.readAsDataURL(e),n.promise()}}),t.fn[n]=function(i){return this.each(function(){t.data(this,"plugin_"+n)||t.data(this,"plugin_"+n,new e(this,i))})}}(jQuery,window,document);